# Description: MPlayer, komut satırı üzerinden kontrol edilen güçlü bir ses/video oynatıcı.
# URL: http://www.mplayerhq.hu
# Packager: milisarge
# Depends on: gtk2 yasm desktop-file-utils libdvdnav libdvdcss cdparanoia libcdio-paranoia libdvdread samba libbluray live xorg-libxvmc opus alsa-utils pulseaudio sdl jack openal sgml-common aalib giflib libjpeg-turbo libmng libpng openjpeg libcaca faac faad2 lame liba52 libdv libmad libmpeg2 libtheora libvpx lzo mpg123 speex xvid libmpcdec xorg-fontconfig freetype gnutls openssl opus unrar libxslt docbook-xsl docbook-xml enca glib xorg-libxxf86dga 

name=mplayer
version=2017-04-29
release=1
source=(http://distfiles.serverop.de/mplayer-$version.tar.xz
		http://www1.mplayerhq.hu/MPlayer/releases/fonts/font-arial-iso-8859-1.tar.bz2 
		mplayer.conf)

build() {
  cd mplayer-$version

  # Keep in line with mplayer CFLAGS, but allow people to set their own march/mtune values.
  export CFLAGS="$(echo $CFLAGS | sed -e 's/-O[s0-3]/-O3/') -ffast-math -fomit-frame-pointer -fno-strict-aliasing"

  rm -f ffmpeg/mp_auto_pull

  ./configure --prefix=/usr \
      --mandir=/usr/man \
      --codecsdir=/usr/share/codecs \
      --confdir=/etc/mplayer
  make
  make DESTDIR=$PKG install

  (cd $PKG/usr/man/man1; rm mencoder.1; ln -s mplayer.1.gz mencoder.1.gz)

  # fonts
  mkdir -p $PKG/usr/share/mplayer
  cp -a $SRC/font-arial-iso-8859-1/font-arial-??-iso-8859-1 \
    $PKG/usr/share/mplayer
  ln -s font-arial-14-iso-8859-1 $PKG/usr/share/mplayer/font

  # config
  mkdir -p $PKG/etc/mplayer
  install -m 644 $SRC/mplayer.conf $PKG/etc/mplayer/
  install -m 644 etc/input.conf $PKG/etc/mplayer/

  # finish up
  rmdir $PKG/usr/lib
  find $PKG -name '*.desc' | xargs chmod g-w
}
